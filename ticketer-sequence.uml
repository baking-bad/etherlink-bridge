@startuml
title Bridge FA2 or FA1.2 tokens to L2 via Ticketer\nbatch of three operations
actor       User          as User
participant FAToken [
    =FA Token
]
participant Ticketer [
    =Ticketer
]
participant Rollup [
    =Rollup
]

note over Ticketer : **storage:**\nrollup_address
/ note over Rollup : **storage:**

User -> FAToken : approve
activate FAToken
FAToken --> User
deactivate FAToken

User -> Ticketer : deposit
activate Ticketer
Ticketer -> FAToken : transfer
activate FAToken
note over FAToken: from: User\nto: Ticketer\namount: nat
FAToken --> Ticketer
deactivate FAToken
note over Ticketer : convert token\nmetadata to payload
create "L1 Ticket" as L1Ticket
Ticketer -> L1Ticket : new ticket
note over L1Ticket : **new ticket**\n\nticketer: Ticketer\nowner: User\namount: nat\npayload: bytes
Ticketer -> Rollup : bridge ticket
activate Rollup
note over Rollup : ticket: Ticket\nowner: User
note over L1Ticket : **transfer ticket**\n\nticketer: Ticketer\nowner: User\namount: nat\nto: Rollup
create "L2 Ticket" as L2Ticket
Rollup -> L2Ticket
activate L2Ticket
note over L2Ticket : **new ticket**
L2Ticket --> Rollup
deactivate L2Ticket
Rollup --> Ticketer
deactivate Rollup
Ticketer --> User
deactivate Ticketer


@enduml
